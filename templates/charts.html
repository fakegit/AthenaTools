{% extends "base.html" %}

{% block style %}
    <style>
        textarea{
            width: 100% !important;
            margin-top: 60px;
        }
        .chart{
            width: 500px;
            height: 600px;
        }
    </style>
{% endblock %}

{% block content %}

    <h2 class="sub-header">图表助手</h2>

    {% if msg %}
        <div class="alert alert-danger">
            {{ msg }}
        </div>
    {% endif %}

    <div class="row">
        <div class="col-sm-4">
            <form id="form" action="." method="POST">

                <div class="form-group">
                    <textarea class="form-control" name="text1" rows="15">{{ text1 }}</textarea>
                </div>

                <div class="form-group">
                    <input type="submit" name="submit" class="btn btn-info" value="生成图表 >>">
                </div>

            </form>
        </div>
        <div class="col-sm-8">
            <div id="chart1" class="chart"></div>
        </div>
    </div>

    <hr>


{% endblock %}


{% block script %}
    <script type="text/javascript" src="https://echarts.baidu.com/gallery/vendors/echarts/echarts.min.js"></script>
    <script type="text/javascript">
        var dom = document.getElementById("chart1");
        // var myChart = echarts.init(dom, 'light');
        var myChart = echarts.init(dom);
        var option = {
            title: {
                text: '{{ chart1.title|default:"图表1" }}'
            },
            tooltip: {
                trigger: 'axis'
            },
            legend: {
                data:[
                    {% for s in chart1.series  %}
                        '{{ s.name }}',
                    {% endfor %}
                ]
            },
            toolbox: {
                feature: {
                    dataView: {readOnly: false},
                    saveAsImage: {}
                }
            },
            yAxis: {
                type: 'category',
                boundaryGap: false,
                data: [
                    {% for c in chart1.categories  %}
                        '{{ c }}',
                    {% endfor %}
                ],
                'splitLine': {     //网格线
                    'show': true
                },
            },
            xAxis: {
                type: 'value',
                //interval: 0.05
            },
            series: [
                {% for s in chart1.series %}
                    {
                        name:'{{ s.name }}',
                        type:'line',
                        data:[
                            {% for value in s.data %}
                                {{ value }},
                            {% endfor %}
                        ],
                        itemStyle: {normal: {label: {show: true}}}
                    },
                {% endfor %}
            ]
        };
        myChart.setOption(option, true);
    </script>
{% endblock %}